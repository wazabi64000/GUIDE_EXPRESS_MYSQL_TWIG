<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Étape 2 — Twig et premier rendu</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <header>
    <h1>Étape 2 — Twig et premier rendu</h1>
    <p>Configurer Twig pour le rendu côté serveur dans Express</p>
  <nav class="navbar">
    <a href="01-introduction.html">Introduction</a>
    <a href="02-installation.html">Installation</a>
    <a href="03-arborescence.html">Arborescence</a>
    <a href="04-mvc.html">MVC</a>
    <a href="05-config-env.html">Config & .env</a>
    <a href="06-auth-connexion.html">Auth</a>
    <a href="07-verification-email.html">Vérification Email</a>
    <a href="08-reset-password.html">Reset Password</a>
    <a href="09-gestion-roles.html">Gestion Rôles</a>
    <a href="10-crud-categorie.html">CRUD Catégorie</a>
    <a href="11-crud-annonces.html">CRUD Annonces</a>
    <a href="12-deploiement.html">Déploiement</a>
    <a href="conclusion.html">Conclusion</a>
  </nav>  
</header>

  <main>
    <section class="objectifs">
      <h2>Objectifs</h2>
      <ul>
        <li>Comprendre le rôle d’un moteur de templates</li>
        <li>Installer et configurer Twig dans Express (ESM)</li>
        <li>Créer un rendu simple de page HTML dynamique</li>
        <li>Afficher des données (ex : liste d’annonces) via Twig</li>
      </ul>
    </section>

    <section class="explanation">
      <h2>Qu’est-ce que Twig ?</h2>
      <p>
        Twig est un moteur de templates côté serveur. Il permet de générer des pages HTML dynamiques
        à partir de données fournies par votre application. Contrairement à du HTML statique, Twig
        permet d’utiliser des boucles, conditions et variables directement dans vos fichiers `.twig`.
      </p>
      <p>
        Avantages de Twig :
      </p>
      <ul>
        <li>Séparation claire du code serveur et du HTML</li>
        <li>Code plus propre et maintenable</li>
        <li>Réutilisation facile des composants (partials, layouts)</li>
        <li>Compatible avec Express et ESM</li>
      </ul>
    </section>

    <section class="commands">
      <h2>Installation et configuration</h2>
      <pre><code>
# Installer Twig
npm install twig

# Structure recommandée
mkdir src/views
# Créer un fichier template
touch src/views/index.twig
      </code></pre>

      <p>Dans <code>src/server.js</code>, configurer Express pour utiliser Twig :</p>
      <pre><code>
import express from "express";
import path from "path";
import { fileURLToPath } from "url";
import twig from "twig";

const app = express();
const PORT = 3000;

// Obtenir le chemin absolu pour ESM
const __filename = fileURLToPath(import.meta.url);
const __dirname = path.dirname(__filename);

// Configurer Twig
app.set("views", path.join(__dirname, "views"));
app.set("view engine", "twig");

// Route de test
app.get("/", (req, res) => {
  res.render("index", {
    title: "Accueil Annonces Sportives",
    annonces: [
      { titre: "Tournoi de football", date: "2025-10-15" },
      { titre: "Compétition natation", date: "2025-10-20" }
    ]
  });
});

app.listen(PORT, () => console.log(`Serveur démarré sur http://localhost:${PORT}`));
      </code></pre>
    </section>

    <section class="example">
      <h2>Exemple de template Twig (src/views/index.twig)</h2>
      <pre><code>
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>{{ title }}</title>
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <header>
    <h1>{{ title }}</h1>
  </header>

  <main>
    <h2>Liste des annonces</h2>
    <ul>
      {% for annonce in annonces %}
        <li>{{ annonce.titre }} - {{ annonce.date }}</li>
      {% endfor %}
    </ul>
  </main>

  <footer>
    <p>&copy; 2025 Annonces Sportives</p>
  </footer>
</body>
</html>
      </code></pre>
      <p>En lançant le serveur, la page affiche dynamiquement la liste d’annonces définie côté serveur.</p>
    </section>

    <section class="next-step">
      <a href="03-mysql.html" class="btn">Étape suivante : Connexion MySQL</a>
    </section>
  </main>

  <footer>
    <p>&copy; 2025 Cours Annonces Sportives</p>
  </footer>

  <script src="js/app.js"></script>
</body>
</html>
